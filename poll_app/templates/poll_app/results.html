{% extends 'base.html' %}

{% block title %}Results{% endblock %}

{% block content %}
<h1 class="mb-5 text-center">{{ question.question_text }}</h1>

<ul class="list-group mb-5">
    {% for choice in question.choice_set.all %}
    <li class="list-group-item">
        {{ choice.choice_text }}
        <span class="badge bg-danger float-end">{{ choice.votes }} vote{{ choice.votes | pluralize }}</span>
    </li>
    {% endfor %}
</ul>
Total votes: <b>{{ question.total_votes }}</b> | Total views: <b>{{ question.total_views }}</b>
<p></p>

<a class="btn btn-secondary" href="{% url 'poll_app:home' %}">Back To Polls</a>
<a class="btn btn-dark" href="{% url 'poll_app:detail' question.slug %}">Vote again?</a>

<div class="card text-dark bg-warning my-4">
    <h5 class="card-header">Add your comment:</h5>
    {% if user.is_authenticated %}
    <div class="card-body">
        <form method="post">
            {% if form.errors %}
            <div class="alert alert-danger">
                {{ form.errors }}
            </div>
            {% endif %}

            {% csrf_token %}
            <div class="form-group">
                {{ form.comment_text }}
            </div>
            <br>
            <button type="submit" class="btn btn-success">Add comment</button>
        </form>
    </div>
    {% else %}
    <h6 class="card-header"><a href="{% url 'accounts:login' %}">Login</a> or <a href="{% url 'accounts:signup' %}">SignUp</a>
        for to add comments</h6>
    {% endif %}
</div>

<div class="p-3 mb-2 bg-warning text-dark">
    <p>Total comments: <b>({{ comm.count }})</b></p>
</div>

{% for comment in comm %}
<div class="media mb-4">
    <div class="media-body">
        <h5 class="mt-0">{{ comment.author }}</h5>
        {{ comment.comment_text }}
    </div>
</div>
{% endfor %}

{% endblock %}
